<div align="center">
裸K交易系统

基于经典裸K形态的股票分析与回测工具
帮助交易者快速识别市场机会，验证策略有效性

</div>
📖 项目简介
裸K交易系统是一个基于经典裸K形态（Pinbar、吞没、突破）的股票分析与回测工具。它可以帮助交易者快速识别市场中的潜在交易机会，并对历史信号进行回测，验证策略有效性。系统支持今日信号推荐、指定年份回测以及单只股票的详细历史回测。

✨ 主要功能
🔥 今日裸K信号推荐
扫描最新交易日，筛选出符合Pinbar、吞没、突破形态且处于多头趋势（价格在60日均线上方）的股票（剔除创业板、科创板、北交所）。

📈 2026年裸K回测
在指定年份（例如2026年）内寻找符合裸K形态的信号，并对每个信号进行回测，输出买卖点、收益、持有天数等详细数据。

🕰️ 单只股票历史回测
对任意股票在指定时间范围内（默认近5年）进行裸K策略回测，自动识别所有买卖信号，模拟每笔交易，并输出交易明细和统计指标。

🔧 安装依赖
确保已安装Python 3.7及以上版本，并安装以下库：

bash
pip install qstock pandas numpy matplotlib
🚀 使用方法
克隆仓库

bash
git clone https://github.com/derek391/stock-selection.git
运行主程序

bash
python main.py
选择功能（输入对应数字）：

1：获取今日裸K信号推荐

2：对2026年进行裸K回测（需数据源包含2026年数据）

3：单只股票历史回测（输入股票代码，例如 000001 或 平安银行）

0：退出程序

查看结果

推荐结果和回测汇总会直接打印在控制台，并自动保存为CSV文件（文件名包含日期时间）。

回测图表会保存为PNG图片（如 {code}_{name}_2026_backtest.png）。

📊 功能详解
🔥 今日裸K信号推荐
逻辑：在基础筛选（股价5-200元，换手率2-50%，非ST）后，剔除创业板/科创板/北交所股票。获取最近180天历史数据，识别最新K线是否符合Pinbar、吞没或突破形态，且收盘价高于60日均线。

输出：股票代码、名称、信号类型、最新价、信号日期、市盈率、换手率。

📈 2026年裸K回测
数据准备：需确保qstock数据源包含2026年数据（程序会先测试）。基础筛选同今日推荐，然后取换手率前300只股票进行分析。

信号识别：在2026年内，对每只股票寻找第一个符合裸K形态且价格在60日线上方的信号。

回测规则：

买入价：信号当日收盘价。

止损：买入价 - 2倍ATR（14日ATR）。

止盈：买入价 + 4倍ATR。

移动止盈：从最高点回落超过1.5倍ATR时卖出。

时间止损：持仓超过20个交易日强制卖出。

输出：每笔交易的买入/卖出日期、价格、收益、持有天数、卖出原因。

🕰️ 单只股票历史回测
时间范围：默认回测近5年数据（可自定义起始/结束日期）。

信号识别：在历史数据中遍历所有K线，识别裸K形态，要求价格高于60日均线。每笔交易结束后继续寻找下一个信号，避免重叠。

回测规则：同上。

输出：

交易明细表：买入/卖出日期、价格、持有天数、盈亏百分比、卖出原因、信号类型。

统计指标：总交易次数、胜率、总盈亏、平均盈亏、平均盈利/亏损等。

📁 文件说明
文件/文件夹	说明
naked_trading_system.py	主程序文件，包含所有功能
market_data/	缓存文件夹，存放每日实时行情CSV文件
*_recommend_*.csv	今日推荐结果
naked_2026_signals_*.csv	2026年候选信号
naked_2026_summary_*.csv	2026年回测汇总
backtest_*_*.csv	单只股票历史回测明细
*_backtest.png	单个信号的回测图表
⚠️ 注意事项
数据源：本系统依赖 qstock 获取数据，请确保网络畅通。如果数据源未更新到2026年，选项2将无法使用。

板块排除：今日推荐和2026年回测默认排除创业板（300开头）、科创板（688开头）、北交所（8开头）股票，如需包含可修改代码。

风险提示：本系统仅为技术分析工具，不构成投资建议。实际交易请结合更多信息谨慎决策。

======================================================================
🏆 【2026年裸K交易回测汇总】
======================================================================
    名称   信号日期 信号类型  买入价  卖出价   卖出日期  策略收益%  持有天数      卖出原因
嘉美包装 2026-01-05     突破   13.70   17.55 2026-01-13      28.10         8   take_profit
易点天下 2026-01-05     突破   43.18   52.69 2026-01-09      22.02         4   take_profit
德才股份 2026-01-05     突破   28.51   33.84 2026-01-14      18.70         9   take_profit
丰倍生物 2026-01-05     吞没   42.39   49.06 2026-01-09      15.73         4   take_profit
  爱迪特 2026-01-05     突破   46.58   51.90 2026-01-21      11.42        16   take_profit
  新华网 2026-01-05     突破   20.11   22.24 2026-01-09      10.59         4   take_profit
天娱数科 2026-01-05     突破    6.69    7.35 2026-01-09       9.87         4   take_profit
北摩高科 2026-01-05     突破   32.37   33.45 2026-01-15       3.34        10 trailing_stop
中环海陆 2026-01-05   Pinbar   28.89   29.56 2026-01-13       2.32         8 trailing_stop
南兴股份 2026-01-05     突破   21.42   21.61 2026-01-07       0.89         2 trailing_stop


📄 许可证
本项目采用 MIT 许可证。详见 LICENSE 文件。
